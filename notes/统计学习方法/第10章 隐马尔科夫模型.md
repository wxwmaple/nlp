# 第10章 隐马尔科夫模型

## 概述

- 关于时序的**概率**模型
- 马尔科夫链->状态随机序列（不可观测）->观测随机序列（可观测）
- 马尔科夫链：一组具有马尔可夫性质的离散随机变量的集合
  - 状态决定观测
  - 当前的状态只由前一个状态影响
  - 如：一个随机变量序列（X1，X2,……,X10），每个Xi是一个词性随机变量。X1先随机取值（比如X1="O"），然后O对应某个单字（比如“我”）。X2再随机取值，（比如X2="B-疾病"，且X2受X1的影响），然后B-疾病对应某个单字（比如“咳”），以此类推……

## 三个重要矩阵&两个重要集合

- 状态转移矩阵（状态->状态的条件概率）A
- 发射矩阵（状态->观测的条件概率）B
- 初始状态矩阵π

----

- 观测集V
- 状态集Q

----

- 如：给语料（我，咳，嗽，了），（注，射，青，霉，素），标签分别为（O，B-疾病，I-疾病，O），（B-治疗，I-治疗，B-药物，I-药物，I-药物），请求出上述矩阵和集合

## 实际应用（以CCKS数据集为例）

- 用语料求出A、B、π
- 向算法函数输入A、B、π和观测序列O，求出最可能的状态序列I
  - 遍历：指数爆炸
![1](https://pic4.zhimg.com/80/v2-8a0e2bc64b7305a04c3aef847fa62bdb_hd.jpg)
  - Viterbi算法：“剪枝”，减小复杂度
![2](https://pic1.zhimg.com/80/v2-ab128a2158510b6885daba65c7de50e0_hd.jpg)
![3](https://pic2.zhimg.com/80/v2-7ddbccbba833ec8158c07c7bd22d56c1_hd.jpg)
- 练习：我们已知如下条件，问状态序列是什么？
- 隐含的身体状态 = { 健康 , 发烧 }
- 可观察的感觉状态 = { 正常 , 冷 , 头晕 }
- A：{ 健康->健康： 0.7 ,发烧->健康：0.4 ,
       健康->发烧： 0.3 ,发烧->发烧：0.6}
- B：{健康，正常：0.5 ，冷 ：0.4 ，头晕： 0.1 ；
      发烧，正常：0.1 ，冷 ：0.3 ，头晕： 0.6 }
- π：{ 健康：0.6 , 发烧： 0.4 }
- 观测序列：｛正常，冷，头晕｝
![4](https://upload-images.jianshu.io/upload_images/16186410-808c3aca506cf457.png?imageMogr2/auto-orient/strip|imageView2/2/w/720)